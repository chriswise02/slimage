<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Optimizer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>SlImage</h1>
        <div class="upload-section">
            <div class="drop-zone" id="dropZone">
                <input type="file" id="imageInput" accept=".jpg,.jpeg,.png,.webp" />
                <label for="imageInput" class="upload-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7,10 12,15 17,10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Upload Image
                </label>
                <div class="drop-zone-text">
                    <p>Drop an image here or click to upload</p>
                    <span>Supports JPG, PNG, WebP files</span>
                </div>
            </div>
        </div>

        <div class="filter-section" id="filterSection" style="display: none;">
            <h2>Choose a Filter</h2>
            <div class="filter-options">
                <div class="filter-option" data-filter="none">
                    <div class="filter-preview">
                        <div class="no-filter-preview">Original</div>
                    </div>
                    <span>Compression</span>
                </div>
                <div class="filter-option" data-filter="custom-crop">
                    <div class="filter-preview">
                        <div class="custom-crop-preview">
                            <div class="crop-frame">
                                <div class="crop-handles">
                                    <div class="crop-handle corner-tl"></div>
                                    <div class="crop-handle corner-tr"></div>
                                    <div class="crop-handle corner-bl"></div>
                                    <div class="crop-handle corner-br"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <span>Custom Crop</span>
                </div>
                <div class="filter-option" data-filter="triangular-mask">
                    <div class="filter-preview">
                        <div class="triangular-mask-preview">
                            <div class="triangle-top"></div>
                            <div class="triangle-bottom"></div>
                        </div>
                    </div>
                    <span>Triangular Mask</span>
                </div>
                <div class="filter-option" data-filter="rounded-rectangle">
                    <div class="filter-preview">
                        <div class="rounded-rectangle-preview"></div>
                    </div>
                    <span>Rounded Rectangle</span>
                </div>
                <div class="filter-option" data-filter="rounded-corners">
                    <div class="filter-preview">
                        <div class="rounded-corners-preview"></div>
                    </div>
                    <span>Rounded Corners</span>
                </div>
                
                <div class="filter-option" data-filter="slant-top-red">
                    <div class="filter-preview" style="
                        background-image: url('https://assets.doordash.team/m/3abc993d3d3ce59f/original/TOP-SLANT-COLOR.png');
                        background-size: cover;
                        background-position: center;">
                    </div>
                    <span>Top Pinot</span>
                </div>

                <div class="filter-option" data-filter="slant-top-pinot">
                    <div class="filter-preview" style="
                        background-image: url('https://assets.doordash.team/m/6ef3d933125cfbcf/original/TOP-SLANT-COLOR-1.png');
                        background-size: cover;
                        background-position: center;">
                    </div>
                    <span>Top Red</span>
                </div>

                <div class="filter-option" data-filter="slant-bottom-pinot">
                    <div class="filter-preview" style="
                        background-image: url('https://assets.doordash.team/m/5ef5ee0b564cda5c/original/TOP-SLANT-COLOR-2.png');
                        background-size: cover;
                        background-position: center;">
                    </div>
                    <span>Bottom Pinot</span>
                </div>

                <div class="filter-option" data-filter="slant-bottom-red">
                    <div class="filter-preview" style="
                        background-image: url('https://assets.doordash.team/m/7fbe6045e786226f/original/TOP-SLANT-COLOR-1-1.png');
                        background-size: cover;
                        background-position: center;">
                    </div>
                    <span>Bottom Red</span>
                </div>
            </div>
            <button id="applyFilterBtn" class="apply-filter-btn" disabled>Apply Filter & Optimize</button>
        </div>

        <div class="crop-section" id="cropSection" style="display: none;">
            <h2>Custom Crop</h2>
            <div class="crop-controls">
                <div class="aspect-ratio-controls">
                    <label>Aspect Ratio:</label>
                    <select id="aspectRatio">
                        <option value="free">Free Form</option>
                        <option value="1:1">1:1 (Square)</option>
                        <option value="16:9">16:9 (Widescreen)</option>
                        <option value="4:3">4:3 (Standard)</option>
                        <option value="3:2">3:2 (Photography)</option>
                        <option value="9:16">9:16 (Portrait)</option>
                    </select>
                </div>
                <div class="dimension-controls">
                    <label>Custom Size:</label>
                    <input type="number" id="cropWidth" placeholder="Width" min="1">
                    <span>×</span>
                    <input type="number" id="cropHeight" placeholder="Height" min="1">
                    <span>px</span>
                </div>
            </div>
            <div class="crop-canvas-container">
                <canvas id="cropCanvas"></canvas>
                <div class="crop-overlay" id="cropOverlay">
                    <div class="crop-selection" id="cropSelection">
                        <!-- Corner handles -->
                        <div class="resize-handle corner top-left" data-direction="nw"></div>
                        <div class="resize-handle corner top-right" data-direction="ne"></div>
                        <div class="resize-handle corner bottom-left" data-direction="sw"></div>
                        <div class="resize-handle corner bottom-right" data-direction="se"></div>
                        
                        <!-- Edge handles -->
                        <div class="resize-handle edge top" data-direction="n"></div>
                        <div class="resize-handle edge right" data-direction="e"></div>
                        <div class="resize-handle edge bottom" data-direction="s"></div>
                        <div class="resize-handle edge left" data-direction="w"></div>
                    </div>
                </div>
            </div>
            <div class="crop-actions">
                <button id="applyCropBtn" class="apply-crop-btn">Apply Crop</button>
                <button id="cancelCropBtn" class="skip-crop-btn">Cancel</button>
            </div>
        </div>
        
        <div class="preview-section" id="previewSection" style="display: none;">
            <div class="image-container">
                <div class="comparison-container">
                    <div class="image-comparison">
                        <div class="comparison-before">
                            <img id="originalImage" alt="Original image">
                            <div class="image-label">Original</div>
                        </div>
                        <div class="comparison-after">
                            <img id="optimizedImage" alt="Processed image">
                            <div class="image-label">Processed</div>
                        </div>
                    </div>
                </div>
                <div class="size-info">
                    <div class="size-card">
                        <h4>Original</h4>
                        <p id="originalSize"></p>
                    </div>
                    <div class="size-card">
                        <h4>Processed</h4>
                        <p id="optimizedSize"></p>
                    </div>
                </div>
                <div class="individual-downloads" id="individualDownloads" style="display: none;">
                    <button id="downloadTopBtn" class="individual-download-btn">Download Top Half</button>
                    <button id="downloadBottomBtn" class="individual-download-btn">Download Bottom Half</button>
                </div>
            </div>
            
            <div class="controls">
                <div class="quality-controls">
                    <div class="quality-section">
                        <div class="quality-header">
                            <label for="qualitySlider">Optimization Level:</label>
                            <span class="format-indicator" id="formatIndicator">JPEG</span>
                        </div>
                        <div class="quality-slider-container">
                            <input type="range" id="qualitySlider" min="10" max="100" value="60" step="5">
                            <span id="qualityValue">60%</span>
                        </div>
                        <div class="quality-presets">
                            <button class="quality-preset" data-quality="30">High Compression (30%)</button>
                            <button class="quality-preset" data-quality="60">Balanced (60%)</button>
                            <button class="quality-preset" data-quality="85">High Quality (85%)</button>
                        </div>
                        <div class="quality-note" id="qualityNote" style="display: none;">
                            <span>ℹ️ For PNG: Higher quality = more colors preserved = larger file size</span>
                        </div>
                    </div>
                    <div class="optimization-info">
                        <span class="optimization-label">Max width: 1400px • JPEG/PNG quality control • Auto size-capped</span>
                    </div>
                </div>
            </div>
            
            <button id="downloadBtn" class="download-btn">Download Processed Image</button>
            <button id="resetBtn" class="reset-btn">Process Another Image</button>
        </div>
        
        <div class="loading" id="loading" style="display: none;">
            <p>Processing image...</p>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>